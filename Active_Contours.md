# Active Contours

## Introduction
Active Contours (Snakes) are energy minimising splines that deform to fit features. Snakes lock on to nearby minima in the potential energy generated by processing an image. This energy is minimied by using an iterative gradient descent process which depends on forces derived using variational calculus and Euler Lagrange Theory. In addition, _internal_ (smoothing) forces produce tension and stiffness that constrain the behaviour of the models and _external_ forces may be specified by a supervising process or human user. For example, Gaussian smoothing followed by convolution with a gradiaent-squared operator generates a potential in which extreme correspond to edges in the original image. Over a series of iterations the force generated by this energy drives the snake into alignment with the nearest salient edge, as shown in the figure below. However, the snake must also satisfy some internal constraints – for example, it must be smooth and continuous in outline. Sometimes the user imposes additional external constraints such as attraction or repulsion.

<p align="center">
<img src="https://github.com/jayerfernandes/CS766/blob/master/activesnakes1.png?raw=true" width="500" >
</p>

Active Snakes do not try to solve the entire problem of finding salient image contours. They rely on other mechanisms to place them somewhere near the desired contour. However, even in cases where no satisfactory automatic starting mechanism exists, snakes can still be used for semiautomatic image interpretation. If an expert user pushes a snake close to an intended contour, its energy minimization will carry it the rest of the way. The minimization provides a ‘power assist’ for a person pointing to a contour feature.

Many motion tracking systems utilize active snakes to model moving objects. The main limitations of the models are
1. that they usually only incorporate edge information (ignoringother image characteristics) possibly combined with some prior expectation of shape.
2. that they must be initialised close to the feature of interest if they are to avoid being trapped by other local minima.

## Snake Energy Functionals
A snake is a parametric contour that deforms over a series of iteratinos. Each element **x**(_s,t_) along the contour therefore depends on two parameters:

s = space(curve) parameter

t = time (iteration) parameter

The contour is influenced by internal and external constraints and by image forces as outlined below:

1. **Internal Forces**: Internal constraints give the model tension and stiffness.
2. **External Forces**: External constraints come from high level sources such as human operators or automatic initialization procedures.
3. **Image Forces** Image energy is used to drive the model towards salient features such as light and dark regions, edges and terminations.

The snake can be parametrically represented as:

![equation](https://latex.codecogs.com/gif.latex?E_{snake}&space;=&space;\int_{0}^{1}E_{element}(\mathbf{x}(s)))ds)                

It should be noted that while the integration implies and open-ended snake, joining the first and last elements makes the snake into a closed loop.

The above equation can be re-written in terms of the energy functionals as

![equation](https://latex.codecogs.com/gif.latex?E_{snake}&space;=&space;\int_{0}^{1}E_{internal}(\mathbf{x})ds&space;&plus;&space;\int_{0}^{1}E_{external}(\mathbf{x})ds&space;&plus;&space;\int_{0}^{1}E_{image}(\mathbf{x})ds) 


### Internal Snake Energy
The internal energy of the snake element can be written as

![equation](https://latex.codecogs.com/gif.latex?E_{internal}(\mathbf{x})&space;=&space;\alpha&space;\left&space;|x_{s}(s)&space;\right&space;|^2&space;&plus;&space;\beta&space;\left&space;|x_{ss}(s)&space;\right&space;|^2) 

The first order term controls the _tension_ and makes the snake contract like an elastic band by introducing tension. The second-order term controls the _stiffness_ and makes it resistant to bending. In other words, the parametric curve is predisposed to have constant (preferably zero) ‘velocity’ and ‘acceleration’ with respect to its parameter.

In the absence of other constraints, an active contour model simply collapses to a point
like a strip of infinitely-elastic material; however, if the ends of the model are anchored then it
forms a straight line along which the elements are evenly spaced. Adjusting the weights α(s)
and β(s) controls the relative importance of the tension and stiffness terms.



### External Snake Energy

Both automatic and manual supervision can be used to control attraction and repulsion forces that drive active contour models to or form specified features. For example, a spring like attractive force can be generated between a snake element and a point **i** in an image using the following external energy term

![equation](https://latex.codecogs.com/gif.latex?E_{external}(\mathbf{x})&space;=&space;k&space;\left&space;|\mathbf{i-x}&space;\right&space;|)

This energy is minimal when **x=i** and it takes the value of _k_ when **i-x** = ±1.

The external energy term can also be used to make part of an image repel an active contour model by shifting the **|i-x|** term to the denominator as shown below

![equation](https://latex.codecogs.com/gif.latex?E_{external}(\mathbf{x})&space;=&space;\frac{k}{\left&space;|\mathbf{i-x}&space;\right&space;|})\

This energy is maximal when **x=i** and it takes the value of _k_ when **i-x** = ±k. The repulsion term must be clipped as the denominator tends to zero to avoid the singularity.


### Image (Potential) Energy 
In order to make snakes useful for vision, additional energy terms need to be incorporated in order to attract them to salient features in images such as lines, edges and terminations. The total image energy can thus be expressed as a weighted combination of the three energy funcationals as shown below

![equation](https://latex.codecogs.com/gif.latex?P&space;=&space;E_{image}&space;=&space;w_{line}E_{line}&space;&plus;&space;w_{edge}E_{edge}&space;&plus;&space;w_{termination}E_{termination})
           
#### Line Functional
